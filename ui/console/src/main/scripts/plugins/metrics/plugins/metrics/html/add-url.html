<div ng-controller="HawkularMetrics.AddUrlController as vm">
  <div class="hk-fade-in" ng-class="{'hk-urls-list text-center': vm.resourceList.length === 0}">
    <h1 class="text-center">Hello {{userDetails.firstName}}!</h1>
    <i class="fa fa-line-chart" ng-show="vm.resourceList.length === 0"></i>
    <h2 ng-show="vm.resourceList.length === 0">Collect metrics from a website that you want to monitor.</h2>
    <form class="form-horizontal hk-add-url" name="addUrlForm" role="form" novalidate ng-submit="vm.addUrl(vm.resourceUrl)">
      <div class="form-group input">
        <div class="col-lg-6 col-sm-8 col-xs-12 hk-align-center">
          <div class="input-group input-group-lg">
            <input type="url" class="form-control" name="resourceUrl" ng-model="vm.resourceUrl"
                   ng-model-options="{ updateOn: 'default blur'}"
                   placeholder="Enter a website URL (e.g.: http://www.website.com)" required>
            <span class="input-group-btn">
              <button class="btn btn-primary" type="submit" ng-disabled="addUrlForm.$invalid || vm.addProgress">
               <div ng-show="vm.addProgress" class="spinner spinner-sm"></div>
              Add URL
              </button>
            </span>
          </div>
          <span class="help-block"
                  ng-show="addUrlForm.resourceUrl.$dirty && addUrlForm.resourceUrl.$invalid">The URL you entered is not valid. Please enter a valid URL.</span>

        </div>
      </div>
    </form>
  </div>

  <h2 ng-show="vm.resourceList.length > 0" class="text-center hk-fade-in">Current status of your websites</h2>

  <div class="row hk-urls-list-labels hk-fade-in" ng-show="vm.resourceList.length > 0">
    <div class="col-sm-6 text-left">
      <button class="btn btn-link" tooltip="Sort" tooltip-trigger tooltip-placement="top" ng-click="vm.reverse = !vm.reverse">
        URL (A-Z) <i class="fa" ng-class="vm.reverse ? 'fa-angle-up' : 'fa-angle-down'"></i>
      </button>
    </div>
    <div class="col-sm-6 text-right">
      Last update
      <span class="hk-update pull-right" data-toggle="tooltip" data-placement="top" title="Last update"><i class="fa fa-clock-o"></i>{{vm.lastUpdateTimestamp| date:"HH:mm" }}</span>
    </div>
  </div>

  <div class="hk-fade-in">
    <div class="hk-url-item" ng-repeat="res in vm.resourceList | orderBy:'properties.url':vm.reverse">
      <div class="hk-url-heading">
        <a href="/hawkular-ui/url/availability/{{res.id}}">{{res.properties.url}}</a>
      </div>
      <div class="panel panel-default hk-summary">
        <div class="row">
          <div class="col-sm-3 hk-summary-item">
            <a href="/hawkular-ui/url/availability/{{res.id}}">
              <span class="hk-data">{{(vm.alertList|filter:{triggerId: (res.id + '_trigger')}).length || 0}} <i class="fa fa-flag" ng-show="(vm.alertList|filter:{triggerId: (res.id + '_trigger')}).length > 0"></i></span>
              <span class="hk-item">Unresolved Alerts</span>
            </a>
          </div>
          <div class="col-sm-3 hk-summary-item">
            <a href="/hawkular-ui/url/availability/{{res.id}}">
              <span class="hk-data" ng-show="res.responseTime.length > 0"><i class="fa " ng-class="res.isUp ? 'fa-arrow-up' : 'fa-arrow-down'"></i>{{res.isUp ? 'Up' : 'Down'}}</span>
              <span class="hk-data spinner" ng-hide="res.responseTime.length > 0" popover="Your data is being collected. You should see something in a few seconds." popover-trigger="mouseenter" popover-placement="bottom"></span>
              <span class="hk-item">Availability</span>
            </a>
          </div>
          <div class="col-sm-3 hk-summary-item">
            <a href="/hawkular-ui/url/availability/{{res.id}}">
              <span class="hk-data">n/a</span>
              <span class="hk-item">Last Downtime</span>
            </a>
          </div>
          <div class="col-sm-3 hk-summary-item">
            <a href="/hawkular-ui/url/availability/{{res.id}}">
              <span class="hk-data" ng-show="res.responseTime.length > 0">{{res.responseTime[0].value}} <span>ms</span></span>
              <span class="hk-data spinner" ng-hide="res.responseTime.length > 0" popover="Your data is being collected. You should see something in a few seconds." popover-trigger="mouseenter" popover-placement="bottom"></span>
              <span class="hk-item">Response Time</span>
            </a>
          </div>
        </div>
        <button class="btn btn-link hk-delete" tooltip="Remove" tooltip-trigger tooltip-placement="top" ng-click="vm.deleteResource(res)"><i class="fa fa-trash-o"></i></button>
      </div>
    </div>
  </div>

  <div class="text-center hk-fade-in">
    <ul class="pagination" ng-show="vm.resourceList.length > 0">
      <li>
        <a href="#" ng-click="vm.setPage(vm.resCurPage-1)">
          <span class="i fa fa-angle-left"></span>
        </a>
      </li>
      <li ng-class="{'active' : vm.resCurPage === 0}"><a href="#" ng-click="vm.setPage(0)">1</a></li>
      <li ng-class="{'active' : vm.resCurPage === 1}"><a href="#" ng-click="vm.setPage(1)">2</a></li>
      <li ng-class="{'active' : vm.resCurPage === 2}"><a href="#" ng-click="vm.setPage(2)">3</a></li>
      <li ng-class="{'active' : vm.resCurPage === 3}"><a href="#" ng-click="vm.setPage(3)">4</a></li>
      <li ng-class="{'active' : vm.resCurPage === 4}"><a href="#" ng-click="vm.setPage(4)">5</a></li>
      <li>
        <a href="#" ng-click="vm.setPage(vm.resCurPage+1)">
          <span class="i fa fa-angle-right"></span>
        </a>
      </li>
    </ul>
  </div>

</div>
